<!DOCTYPE html><html lang="zh-CN" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>d.ts 类型声明文件 - TypeScript 教程 - 网道</title><!-- link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" --><link rel="stylesheet" href="assets/css/app.min.css"><link rel="stylesheet" href="https://apps.bdimg.com/libs/fontawesome/4.4.0/css/font-awesome.css"><!-- link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css"--><!-- link rel="stylesheet" href="assets/css/share.min.css" --><meta property="og:type" content="article"><meta property="og:title" content="d.ts 类型声明文件"><link rel="apple-touch-icon" href="assets/icons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="192x192" href="assets/icons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="assets/icons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="assets/icons/favicon-16x16.png"><link rel="manifest" href="assets/icons/manifest.json"></head><body><nav class="navbar is-light" role="navigation" id="navbar" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a href="/" class="navbar-item title has-text-grey has-text-weight-light is-5">网道 / WangDoc.com </a><a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span> <span aria-hidden="true"></span> <span aria-hidden="true"></span></a></div><div class="navbar-menu" id="navMenu"><div class="navbar-end"><div class="navbar-item"><form action="https://sourcegraph.com/search" target="_blank" method="get" onsubmit='this.q.value="repo:^github.com/wangdoc/typescript-tutorial$ "+this.origin.value'><p class="control has-icons-right"><input class="input" type="text" name="origin" placeholder="搜索..."> <span class="icon is-small is-right"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="#ddd" d="M23.822 20.88l-6.353-6.354c.93-1.465 1.467-3.2 1.467-5.059.001-5.219-4.247-9.467-9.468-9.467s-9.468 4.248-9.468 9.468c0 5.221 4.247 9.469 9.468 9.469 1.768 0 3.421-.487 4.839-1.333l6.396 6.396 3.119-3.12zm-20.294-11.412c0-3.273 2.665-5.938 5.939-5.938 3.275 0 5.94 2.664 5.94 5.938 0 3.275-2.665 5.939-5.94 5.939-3.274 0-5.939-2.664-5.939-5.939z"/></svg></span></p><input type="hidden" name="q" value=""> <input type="hidden" name="patternType" value="literal"></form></div><a class="navbar-item is-hidden-desktop-only" target="_blank" href="https://github.com/wangdoc/typescript-tutorial"><span class="icon" style="color: #333;"><i class="fa fa-lg fa-github"></i></span></a></div></div></div></nav><section class="section main article"><div class="container"><div class="columns"><div class="column is-8 is-6-widescreen is-offset-1-widescreen"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="index.html"><span class="icon"><i class="fa fa-home"></i></span> &nbsp;TypeScript 教程</a></li><li class="is-active"><a class="has-text-grey" href="d.ts.html">d.ts 类型声明文件</a></li></ul></nav><nav class="level level-previous-next is-mobile"><!-- Left side --><div class="level-left"><p class="level-item is-narrow"><a href="declare.html"><span class="icon"><i class="fa fa-toggle-left"></i></span> declare 关键字</a></p></div><div class="level-right"><p class="level-item is-narrow"><a href="operator.html">运算符 <span class="icon"><i class="fa fa-toggle-right"></i></span></a></p></div></nav><article class="content"><h1 class="title">d.ts 类型声明文件</h1><div class="page-meta"><p>网道（WangDoc.com），互联网文档计划</p></div><h2 id="简介">简介 <a class="markdownIt-Anchor" href="#简介">#</a></h2><p>单独使用的模块，一般会同时提供一个单独的类型声明文件（declaration file），把本模块的外部接口的所有类型都写在这个文件里面，便于模块使用者了解接口，也便于编译器检查使用者的用法是否正确。</p><p>类型声明文件里面只有类型代码，没有具体的代码实现。它的文件名一般为<code>[模块名].d.ts</code>的形式，其中的<code>d</code>表示 declaration（声明）。</p><p>举例来说，有一个模块的代码如下。</p><pre class="hljs"><code><span class="hljs-keyword">const</span> maxInterval = <span class="hljs-number">12</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getArrayLength</span>(<span class="hljs-params">arr</span>) {
  <span class="hljs-keyword">return</span> arr.<span class="hljs-property">length</span>;
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  getArrayLength,
  maxInterval,
};
</code></pre><p>它的类型声明文件可以写成下面这样。</p><pre class="hljs"><code><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getArrayLength</span>(<span class="hljs-params">arr: <span class="hljs-built_in">any</span>[]</span>): <span class="hljs-built_in">number</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">maxInterval</span>: <span class="hljs-number">12</span>;
</code></pre><p>类型声明文件也可以使用<code>export =</code>命令，输出对外接口。下面是 moment 模块的类型声明文件的例子。</p><pre class="hljs"><code><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">&#x27;moment&#x27;</span> {
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">moment</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">any</span>;
  <span class="hljs-keyword">export</span> = moment;
}
</code></pre><p>上面示例中，模块<code>moment</code>内部有一个函数<code>moment()</code>，而<code>export =</code>表示<code>module.exports</code>输出的就是这个函数。</p><p>除了使用<code>export =</code>，模块输出在类型声明文件中，也可以使用<code>export default</code>表示。</p><pre class="hljs"><code><span class="hljs-comment">// 模块输出</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-number">3.142</span>;

<span class="hljs-comment">// 类型输出文件</span>
<span class="hljs-comment">// 写法一</span>
<span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">pi</span>: <span class="hljs-built_in">number</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> pi;

<span class="hljs-comment">// 写法二</span>
<span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">pi</span>: <span class="hljs-built_in">number</span>;
<span class="hljs-keyword">export</span>= pi;
</code></pre><p>上面示例中，模块输出的是一个整数，那么可以用<code>export default</code>或<code>export =</code>表示输出这个值。</p><p>下面是一个如何使用类型声明文件的简单例子。有一个类型声明文件<code>types.d.ts</code>。</p><pre class="hljs"><code><span class="hljs-comment">// types.d.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Character</span> {
  catchphrase?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
}
</code></pre><p>然后，就可以在 TypeScript 脚本里面导入该文件声明的类型。</p><pre class="hljs"><code><span class="hljs-comment">// index.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Character</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./types&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">character</span>:<span class="hljs-title class_">Character</span> = {
  <span class="hljs-attr">catchphrase</span>: <span class="hljs-string">&quot;Yee-haw!&quot;</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Sandy Cheeks&quot;</span>,
};
</code></pre><p>类型声明文件也可以包括在项目的 tsconfig.json 文件里面，这样的话，编译器打包项目时，会自动将类型声明文件加入编译，而不必在每个脚本里面加载类型声明文件。比如，moment 模块的类型声明文件是<code>moment.d.ts</code>，使用 moment 模块的项目可以将其加入项目的 tsconfig.json 文件。</p><pre class="hljs"><code>{
  <span class="hljs-string">&quot;compilerOptions&quot;</span>: {},
  <span class="hljs-string">&quot;files&quot;</span>: [
    <span class="hljs-string">&quot;src/index.ts&quot;</span>,
    <span class="hljs-string">&quot;typings/moment.d.ts&quot;</span>
  ]
}
</code></pre><h2 id="类型声明文件的来源">类型声明文件的来源 <a class="markdownIt-Anchor" href="#类型声明文件的来源">#</a></h2><p>类型声明文件主要有以下三种来源。</p><ul><li>TypeScript 编译器自动生成。</li><li>TypeScript 内置类型文件。</li><li>外部模块的类型声明文件，需要自己安装。</li></ul><h3 id="自动生成">自动生成 <a class="markdownIt-Anchor" href="#自动生成">#</a></h3><p>只要使用编译选项<code>declaration</code>，编译器就会在编译时自动生成单独的类型声明文件。</p><p>下面是在<code>tsconfig.json</code>文件里面，打开这个选项。</p><pre class="hljs"><code>{
  <span class="hljs-string">&quot;compilerOptions&quot;</span>: {
    <span class="hljs-string">&quot;declaration&quot;</span>: <span class="hljs-literal">true</span>
  }
}
</code></pre><p>你也可以在命令行打开这个选项。</p><pre class="hljs"><code>$ tsc --declaration
</code></pre><h3 id="内置声明文件">内置声明文件 <a class="markdownIt-Anchor" href="#内置声明文件">#</a></h3><p>安装 TypeScript 语言时，会同时安装一些内置的类型声明文件，主要是内置的全局对象（JavaScript 语言接口和运行环境 API）的类型声明。</p><p>这些内置声明文件位于 TypeScript 语言安装目录的<code>lib</code>文件夹内，数量大概有几十个，下面是其中一些主要文件。</p><ul><li>lib.d.ts</li><li>lib.dom.d.ts</li><li>lib.es2015.d.ts</li><li>lib.es2016.d.ts</li><li>lib.es2017.d.ts</li><li>lib.es2018.d.ts</li><li>lib.es2019.d.ts</li><li>lib.es2020.d.ts</li><li>lib.es5.d.ts</li><li>lib.es6.d.ts</li></ul><p>这些内置声明文件的文件名统一为“lib.[description].d.ts”的形式，其中<code>description</code>部分描述了文件内容。比如，<code>lib.dom.d.ts</code>这个文件就描述了 DOM 结构的类型。</p><p>如果开发者想了解全局对象的类型接口（比如 ES6 全局对象的类型），那么就可以去查看这些内置声明文件。</p><p>TypeScript 编译器会自动根据编译目标<code>target</code>的值，加载对应的内置声明文件，所以不需要特别的配置。但是，可以使用编译选项<code>lib</code>，指定加载哪些内置声明文件。</p><pre class="hljs"><code>{
  <span class="hljs-string">&quot;compilerOptions&quot;</span>: {
    <span class="hljs-string">&quot;lib&quot;</span>: [<span class="hljs-string">&quot;dom&quot;</span>, <span class="hljs-string">&quot;es2021&quot;</span>]
  }
}
</code></pre><p>上面示例中，<code>lib</code>选项指定加载<code>dom</code>和<code>es2021</code>这两个内置类型声明文件。</p><p>编译选项<code>noLib</code>会禁止加载任何内置声明文件。</p><h3 id="外部类型声明文件">外部类型声明文件 <a class="markdownIt-Anchor" href="#外部类型声明文件">#</a></h3><p>如果项目中使用了外部的某个第三方代码库，那么就需要这个库的类型声明文件。</p><p>这时又分成三种情况。</p><p>（1）这个库自带了类型声明文件。</p><p>一般来说，如果这个库的源码包含了<code>[vendor].d.ts</code>文件，那么就自带了类型声明文件。其中的<code>vendor</code>表示这个库的名字，比如<code>moment</code>这个库就自带<code>moment.d.ts</code>。使用这个库可能需要单独加载它的类型声明文件。</p><p>（2）这个库没有自带，但是可以找到社区制作的类型声明文件。</p><p>第三方库如果没有提供类型声明文件，社区往往会提供。TypeScript 社区主要使用 <a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank" rel="noopener">DefinitelyTyped 仓库</a>，各种类型声明文件都会提交到那里，已经包含了几千个第三方库。</p><p>这些声明文件都会作为一个单独的库，发布到 npm 的<code>@types</code>名称空间之下。比如，jQuery 的类型声明文件就发布成<code>@types/jquery</code>这个库，使用时安装这个库就可以了。</p><pre class="hljs"><code>$ npm install @types/jquery --save-dev
</code></pre><p>执行上面的命令，<code>@types/jquery</code>这个库就安装到项目的<code>node_modules/@types/jquery</code>目录，里面的<code>index.d.ts</code>文件就是 jQuery 的类型声明文件。如果类型声明文件不是<code>index.d.ts</code>，那么就需要在<code>package.json</code>的<code>types</code>或<code>typings</code>字段，指定类型声明文件的文件名。</p><p>TypeScript 会自动加载<code>node_modules/@types</code>目录下的模块，但可以使用编译选项<code>typeRoots</code>改变这种行为。</p><pre class="hljs"><code>{
  <span class="hljs-string">&quot;compilerOptions&quot;</span>: {
    <span class="hljs-string">&quot;typeRoots&quot;</span>: [<span class="hljs-string">&quot;./typings&quot;</span>, <span class="hljs-string">&quot;./vendor/types&quot;</span>]
  }
}
</code></pre><p>上面示例表示，TypeScript 不再去<code>node_modules/@types</code>目录，而是去跟当前<code>tsconfig.json</code>同级的<code>typings</code>和<code>vendor/types</code>子目录，加载类型模块了。</p><p>默认情况下，TypeScript 会自动加载<code>typeRoots</code>目录里的所有模块，编译选项<code>types</code>可以指定加载哪些模块。</p><pre class="hljs"><code>{
  <span class="hljs-string">&quot;compilerOptions&quot;</span>: {
    <span class="hljs-string">&quot;types&quot;</span> : [<span class="hljs-string">&quot;jquery&quot;</span>]
  }
}
</code></pre><p>上面设置中，<code>types</code>属性是一个数组，成员是所要加载的类型模块，要加载几个模块，这个数组就有几个成员，每个类型模块在<code>typeRoots</code>目录下都有一个自己的子目录。这样的话，TypeScript 就会自动去<code>jquery</code>子目录，加载 jQuery 的类型声明文件。</p><p>（3）找不到类型声明文件，需要自己写。</p><p>有时实在没有第三方库的类型声明文件，又很难完整给出该库的类型描述，这时你可以告诉 TypeScript 相关对象的类型是<code>any</code>。比如，使用 jQuery 的脚本可以写成下面这样。</p><pre class="hljs"><code><span class="hljs-keyword">declare</span> <span class="hljs-keyword">var</span> <span class="hljs-attr">$</span>:<span class="hljs-built_in">any</span>

<span class="hljs-comment">// 或者</span>
<span class="hljs-keyword">declare</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">JQuery</span> = <span class="hljs-built_in">any</span>;
<span class="hljs-keyword">declare</span> <span class="hljs-keyword">var</span> <span class="hljs-attr">$</span>:<span class="hljs-title class_">JQuery</span>;
</code></pre><p>上面代码表示，jQuery 的<code>$</code>对象是外部引入的，类型是<code>any</code>，也就是 TypeScript 不用对它进行类型检查。</p><p>也可以采用下面的写法，将整个外部模块的类型设为<code>any</code>。</p><pre class="hljs"><code><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">&#x27;模块名&#x27;</span>;
</code></pre><p>有了上面的命令，指定模块的所有接口都将视为<code>any</code>类型。</p><h2 id="declare-关键字">declare 关键字 <a class="markdownIt-Anchor" href="#declare-关键字">#</a></h2><p>类型声明文件只包含类型描述，不包含具体实现，所以非常适合使用 declare 语句来描述类型。declare 关键字的具体用法，详见《declare 关键字》一章，这里讲解如何在类型声明文件里面使用它。</p><p>类型声明文件里面，变量的类型描述必须使用<code>declare</code>命令，否则会报错，因为变量声明语句是值相关代码。</p><pre class="hljs"><code><span class="hljs-keyword">declare</span> <span class="hljs-keyword">let</span> <span class="hljs-attr">foo</span>:<span class="hljs-built_in">string</span>;
</code></pre><p>interface 类型有没有<code>declare</code>都可以，因为 interface 是完全的类型代码。</p><pre class="hljs"><code><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Foo</span> {} <span class="hljs-comment">// 正确</span>
<span class="hljs-keyword">declare</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Foo</span> {} <span class="hljs-comment">// 正确</span>
</code></pre><p>类型声明文件里面，顶层可以使用<code>export</code>命令，也可以不用，除非使用者脚本会显式使用<code>export</code>命令输入类型。</p><pre class="hljs"><code><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Data</span> {
  <span class="hljs-attr">version</span>: <span class="hljs-built_in">string</span>;
}
</code></pre><p>下面是类型声明文件的一些例子。先看 moment 模块的类型描述文件<code>moment.d.ts</code>。</p><pre class="hljs"><code><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">&#x27;moment&#x27;</span> {
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Moment</span> {
    <span class="hljs-title function_">format</span>(<span class="hljs-attr">format</span>:<span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span>;

    <span class="hljs-title function_">add</span>(
      <span class="hljs-attr">amount</span>: <span class="hljs-built_in">number</span>,
      <span class="hljs-attr">unit</span>: <span class="hljs-string">&#x27;days&#x27;</span> | <span class="hljs-string">&#x27;months&#x27;</span> | <span class="hljs-string">&#x27;years&#x27;</span>
    ): <span class="hljs-title class_">Moment</span>;

    <span class="hljs-title function_">subtract</span>(
      <span class="hljs-attr">amount</span>:<span class="hljs-built_in">number</span>,
      <span class="hljs-attr">unit</span>:<span class="hljs-string">&#x27;days&#x27;</span> | <span class="hljs-string">&#x27;months&#x27;</span> | <span class="hljs-string">&#x27;years&#x27;</span>
    ): <span class="hljs-title class_">Moment</span>;
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">moment</span>(<span class="hljs-params">
    input?: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">Date</span>
  </span>): <span class="hljs-title class_">Moment</span>;

  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> moment;
}
</code></pre><p>上面示例中，可以注意一下默认接口<code>moment()</code>的写法。</p><p>下面是 D3 库的类型声明文件<code>D3.d.ts</code>。</p><pre class="hljs"><code><span class="hljs-keyword">declare</span> <span class="hljs-keyword">namespace</span> D3 {
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Selectors</span> {
    <span class="hljs-attr">select</span>: {
      (<span class="hljs-attr">selector</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Selection</span>;
      (<span class="hljs-attr">element</span>: <span class="hljs-title class_">EventTarget</span>): <span class="hljs-title class_">Selection</span>;
    };
  }

  <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Event</span> {
    <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>;
  }

  <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Base</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Selectors</span> {
    <span class="hljs-attr">event</span>: <span class="hljs-title class_">Event</span>;
  }
}

<span class="hljs-keyword">declare</span> <span class="hljs-keyword">var</span> <span class="hljs-attr">d3</span>: <span class="hljs-variable constant_">D3</span>.<span class="hljs-property">Base</span>;
</code></pre><h2 id="模块发布">模块发布 <a class="markdownIt-Anchor" href="#模块发布">#</a></h2><p>当前模块如果包含自己的类型声明文件，可以在 package.json 文件里面添加一个<code>types</code>字段或<code>typings</code>字段，指明类型声明文件的位置。</p><pre class="hljs"><code>{
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;awesome&quot;</span>,
  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;Vandelay Industries&quot;</span>,
  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,
  <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-string">&quot;./lib/main.js&quot;</span>,
  <span class="hljs-string">&quot;types&quot;</span>: <span class="hljs-string">&quot;./lib/main.d.ts&quot;</span>
}
</code></pre><p>上面示例中，<code>types</code>字段给出了类型声明文件的位置。</p><p>注意，如果类型声明文件名为<code>index.d.ts</code>，且在项目的根目录中，那就不需要在<code>package.json</code>里面注明了。</p><p>有时，类型声明文件会单独发布成一个 npm 模块，这时用户就必须同时加载该模块。</p><pre class="hljs"><code>{
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;browserify-typescript-extension&quot;</span>,
  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;Vandelay Industries&quot;</span>,
  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,
  <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-string">&quot;./lib/main.js&quot;</span>,
  <span class="hljs-string">&quot;types&quot;</span>: <span class="hljs-string">&quot;./lib/main.d.ts&quot;</span>,
  <span class="hljs-string">&quot;dependencies&quot;</span>: {
    <span class="hljs-string">&quot;browserify&quot;</span>: <span class="hljs-string">&quot;latest&quot;</span>,
    <span class="hljs-string">&quot;@types/browserify&quot;</span>: <span class="hljs-string">&quot;latest&quot;</span>,
    <span class="hljs-string">&quot;typescript&quot;</span>: <span class="hljs-string">&quot;next&quot;</span>
  }
}
</code></pre><p>上面示例是一个模块的 package.json 文件，该模块需要 browserify 模块。由于后者的类型声明文件是一个单独的模块<code>@types/browserify</code>，所以还需要加载那个模块。</p><h2 id="三斜杠命令">三斜杠命令 <a class="markdownIt-Anchor" href="#三斜杠命令">#</a></h2><p>如果类型声明文件的内容非常多，可以拆分成多个文件，然后入口文件使用三斜杠命令，加载其他拆分后的文件。</p><p>举例来说，入口文件是<code>main.d.ts</code>，里面的接口定义在<code>interfaces.d.ts</code>，函数定义在<code>functions.d.ts</code>。那么，<code>main.d.ts</code>里面可以用三斜杠命令，加载后面两个文件。</p><pre class="hljs"><code><span class="hljs-comment">/// &lt;reference path=&quot;./interfaces.d.ts&quot; /&gt;</span>
<span class="hljs-comment">/// &lt;reference path=&quot;./functions.d.ts&quot; /&gt;</span>
</code></pre><p>三斜杠命令（<code>///</code>）是一个 TypeScript 编译器命令，用来指定编译器行为。它只能用在文件的头部，如果用在其他地方，会被当作普通的注释。另外，若一个文件中使用了三斜线命令，那么在三斜线命令之前只允许使用单行注释、多行注释和其他三斜线命令，否则三斜杠命令也会被当作普通的注释。</p><p>除了拆分类型声明文件，三斜杠命令也可以用于普通脚本加载类型声明文件。</p><p>三斜杠命令主要包含三个参数，代表三种不同的命令。</p><ul><li>path</li><li>types</li><li>lib</li></ul><p>下面依次进行讲解。</p><h3 id="-reference-path-"><code>/// &lt;reference path=&quot;&quot; /&gt;</code> <a class="markdownIt-Anchor" href="#-reference-path-">#</a></h3><p><code>/// &lt;reference path=&quot;&quot; /&gt;</code>是最常见的三斜杠命令，告诉编译器在编译时需要包括的文件，常用来声明当前脚本依赖的类型文件。</p><pre class="hljs"><code><span class="hljs-comment">/// &lt;reference path=&quot;./lib.ts&quot; /&gt;</span>

<span class="hljs-keyword">let</span> count = <span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre><p>上面示例表示，当前脚本依赖于<code>./lib.ts</code>，里面是<code>add()</code>的定义。编译当前脚本时，还会同时编译<code>./lib.ts</code>。编译产物会有两个 JS 文件，一个当前脚本，另一个就是<code>./lib.js</code>。</p><p>下面的例子是当前脚本依赖于 Node.js 类型声明文件。</p><pre class="hljs"><code><span class="hljs-comment">/// &lt;reference path=&quot;node.d.ts&quot;/&gt;</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">URL</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;url&quot;</span>;
<span class="hljs-keyword">let</span> myUrl = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;https://www.typescriptlang.org&quot;</span>);
</code></pre><p>编译器会在预处理阶段，找出所有三斜杠引用的文件，将其添加到编译列表中，然后一起编译。</p><p><code>path</code>参数指定了所引入文件的路径。如果该路径是一个相对路径，则基于当前脚本的路径进行计算。</p><p>使用该命令时，有以下两个注意事项。</p><ul><li><code>path</code>参数必须指向一个存在的文件，若文件不存在会报错。</li><li><code>path</code>参数不允许指向当前文件。</li></ul><p>默认情况下，每个三斜杠命令引入的脚本，都会编译成单独的 JS 文件。如果希望编译后只产出一个合并文件，可以使用编译选项<code>outFile</code>。但是，<code>outFile</code>编译选项不支持合并 CommonJS 模块和 ES 模块，只有当编译参数<code>module</code>的值设为 None、System 或 AMD 时，才能编译成一个文件。</p><p>如果打开了编译参数<code>noResolve</code>，则忽略三斜杠指令。将其当作一般的注释，原样保留在编译产物中。</p><h3 id="-reference-types-"><code>/// &lt;reference types=&quot;&quot; /&gt;</code> <a class="markdownIt-Anchor" href="#-reference-types-">#</a></h3><p>types 参数用来告诉编译器当前脚本依赖某个 DefinitelyTyped 类型库，通常安装在<code>node_modules/@types</code>目录。</p><p>types 参数的值是类型库的名称，也就是安装到<code>node_modules/@types</code>目录中的子目录的名字。</p><pre class="hljs"><code><span class="hljs-comment">/// &lt;reference types=&quot;node&quot; /&gt;</span>
</code></pre><p>上面示例中，这个三斜杠命令表示编译时添加 Node.js 的类型库，实际添加的脚本是<code>node_modules</code>目录里面的<code>@types/node/index.d.ts</code>。</p><p>可以看到，这个命令的作用类似于<code>import</code>命令。</p><p>注意，这个命令只在你自己手写类型声明文件（<code>.d.ts</code>文件）时，才有必要用到，也就是说，只应该用在<code>.d.ts</code>文件中，普通的<code>.ts</code>脚本文件不需要写这个命令。如果是普通的<code>.ts</code>脚本，可以使用<code>tsconfig.json</code>文件的<code>types</code>属性指定依赖的类型库。</p><h3 id="-reference-lib-"><code>/// &lt;reference lib=&quot;&quot; /&gt;</code> <a class="markdownIt-Anchor" href="#-reference-lib-">#</a></h3><p><code>/// &lt;reference lib=&quot;...&quot; /&gt;</code>命令允许脚本文件显式包含内置 lib 库，等同于在<code>tsconfig.json</code>文件里面使用<code>lib</code>属性指定 lib 库。</p><p>前文说过，安装 TypeScript 软件包时，会同时安装一些内置的类型声明文件，即内置的 lib 库。这些库文件位于 TypeScript 安装目录的<code>lib</code>文件夹中，它们描述了 JavaScript 语言和引擎的标准 API。</p><p>库文件并不是固定的，会随着 TypeScript 版本的升级而更新。库文件统一使用“lib.[description].d.ts”的命名方式，而<code>/// &lt;reference lib=&quot;&quot; /&gt;</code>里面的<code>lib</code>属性的值就是库文件名的<code>description</code>部分，比如<code>lib=&quot;es2015&quot;</code>就表示加载库文件<code>lib.es2015.d.ts</code>。</p><pre class="hljs"><code><span class="hljs-comment">/// &lt;reference lib=&quot;es2017.string&quot; /&gt;</span>
</code></pre><p>上面示例中，<code>es2017.string</code>对应的库文件就是<code>lib.es2017.string.d.ts</code>。</p></article><nav class="level level-previous-next is-mobile"><!-- Left side --><div class="level-left"><p class="level-item is-narrow"><a href="declare.html"><span class="icon"><i class="fa fa-toggle-left"></i></span> declare 关键字</a></p></div><div class="level-right"><p class="level-item is-narrow"><a href="operator.html">运算符 <span class="icon"><i class="fa fa-toggle-right"></i></span></a></p></div></nav><div class="page-info"><p>本教程采用<a href="https://creativecommons.org/licenses/by-sa/3.0/deed.zh" target="_blank">知识共享 署名-相同方式共享 3.0协议</a>。</p><p>分享本文 <span class="social-share"></span></p></div></div><div class="column is-3 is-offset-1"><nav class="panel panel-menu"><p class="panel-heading"><i class="fa fa-book" aria-hidden="true"></i> TypeScript 教程</p><div class="panel-block"><aside class="menu"><p class="menu-label"></p><ul class="menu-list"><li><a href="intro.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">简介</span></a></li><li><a href="basic.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">基本用法</span></a></li><li><a href="any.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">any 类型</span></a></li><li><a href="types.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">类型系统</span></a></li><li><a href="array.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">数组</span></a></li><li><a href="tuple.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">元组</span></a></li><li><a href="symbol.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">symbol 类型</span></a></li><li><a href="function.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">函数</span></a></li><li><a href="object.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">对象</span></a></li><li><a href="interface.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">interface</span></a></li><li><a href="class.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">类</span></a></li><li><a href="generics.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">泛型</span></a></li><li><a href="enum.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">Enum 类型</span></a></li><li><a href="assert.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">类型断言</span></a></li><li><a href="module.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">模块</span></a></li><li><a href="namespace.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">namespace</span></a></li><li><a href="decorator.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">装饰器</span></a></li><li><a href="decorator-legacy.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">装饰器（旧语法）</span></a></li><li><a href="declare.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">declare 关键字</span></a></li><li><a href="d.ts.html" class="is-active"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">d.ts 类型声明文件</span></a></li><li><a href="operator.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">运算符</span></a></li><li><a href="mapping.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">类型映射</span></a></li><li><a href="utility.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">类型工具</span></a></li><li><a href="comment.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">注释指令</span></a></li><li><a href="tsconfig.json.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">tsconfig.json 文件</span></a></li><li><a href="tsc.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">tsc 命令</span></a></li></ul></aside></div></nav><nav class="panel panel-info"><p class="panel-heading"><i class="fa fa-link" aria-hidden="true"></i> 链接</p><div class="panel-block"><aside class="menu"><p class="menu-label"></p><ul class="menu-list"><li><a href="https://raw.githubusercontent.com/wangdoc/typescript-tutorial/master/docs/d.ts.md" target="_blank"><span class="icon"></span><i class="fa fa-code" aria-hidden="true" style="width: 14px;"></i>&nbsp;本文源码</a></li><li><a href="https://github.com/wangdoc/typescript-tutorial" target="_blank"><span class="icon"></span><i class="fa fa-hdd-o" aria-hidden="true" style="width: 14px;"></i>&nbsp;代码仓库</a></li><li><a href="https://github.com/wangdoc/typescript-tutorial/issues" target="_blank"><span class="icon"></span><i class="fa fa-flag-o" aria-hidden="true" style="width: 14px;"></i>&nbsp;反馈</a></li></ul></aside></div></nav></div></div><div class="columns"><div class="column is-8 is-6-widescreen is-offset-1-widescreen"><div id="disqus_thread"></div></div></div></div></section><footer class="footer"><div class="container"><div class="content has-text-centered"><p>联系：contact@wangdoc.com</p></div></div></footer><script>var LOPPO={current_path:"d.ts.md",relative_root_path:"",article_toc:'<ul class="markdownIt-TOC">\n<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>\n<li><a href="#%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6%E7%9A%84%E6%9D%A5%E6%BA%90">类型声明文件的来源</a>\n<ul>\n<li><a href="#%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90">自动生成</a></li>\n<li><a href="#%E5%86%85%E7%BD%AE%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6">内置声明文件</a></li>\n<li><a href="#%E5%A4%96%E9%83%A8%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6">外部类型声明文件</a></li>\n</ul>\n</li>\n<li><a href="#declare-%E5%85%B3%E9%94%AE%E5%AD%97">declare 关键字</a></li>\n<li><a href="#%E6%A8%A1%E5%9D%97%E5%8F%91%E5%B8%83">模块发布</a></li>\n<li><a href="#%E4%B8%89%E6%96%9C%E6%9D%A0%E5%91%BD%E4%BB%A4">三斜杠命令</a>\n<ul>\n<li><a href="#-reference-path-"><code>/// &lt;reference path=&quot;&quot; /&gt;</code></a></li>\n<li><a href="#-reference-types-"><code>/// &lt;reference types=&quot;&quot; /&gt;</code></a></li>\n<li><a href="#-reference-lib-"><code>/// &lt;reference lib=&quot;&quot; /&gt;</code></a></li>\n</ul>\n</li>\n</ul>\n'}</script><script src="assets/js/app.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111269443-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-111269443-1")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?5eec262881855af3dede6a71234571f6",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script>var disqus_config=function(){var t=window.location,e=t.protocol+"//"+t.host+(t.port?":"+t.port:"")+t.pathname;this.page.url=e,this.page.identifier=t.pathname};!function(){var t=document,e=t.createElement("script");e.src="https://wangdoc-typescript.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><!--script src="assets/js/social-share.min.js"--><!--/script--><script>var shareDesc="我正在阅读《d.ts 类型声明文件》，出自网道（WangDoc.com）的《TypeScript 教程》。",shareOpts={url:window.location.href,source:shareDesc,title:shareDesc,description:"",image:"",sites:["weibo","wechat","qq","qzone","twitter","facebook"],origin:"WangDoc_com",disabled:[],wechatQrcodeTitle:"微信",wechatQrcodeHelper:"扫一下二维码，分享到微信。"};socialShare(".social-share",shareOpts)</script></body></html>